\href{http://tools.netsa.cert.org/silk/}{SiLK →}

\begin{quote}
SiLK is a suite of network traffic collection and analysis tools
developed and maintained by the CERT Network Situational Awareness Team
(CERT NetSA) at Carnegie Mellon University to facilitate security
analysis of large networks. The SiLK tool suite supports the efficient
collection, storage, and analysis of network flow data, enabling network
security analysts to rapidly query large historical traffic data sets.
\end{quote}

Since SiLK is the only tool that comes even remotely closer to the
functionality offered by the NFQL, we used it as a reference to compare
the performance of the execution engine.

\subsection{Download and Install SiLK}

\begin{center}\rule{3in}{0.4pt}\end{center}

Download \href{http://tools.netsa.cert.org/silk/}{SiLK →}

\begin{lstlisting}
>> wget http://tools.netsa.cert.org/releases/silk-2.4.7.tar.gz
>> sha1sum silk-2.4.7.tar.gz | grep 2ff0cd1d00de70f667728830aa3e920292e99aec
\end{lstlisting}

Install SiLK

\begin{lstlisting}
>> ./configure
>> make
>> sudo make install
>> sudo ldconfig
\end{lstlisting}

\subsection{SiLK Analysis Tools:}

\begin{center}\rule{3in}{0.4pt}\end{center}

Absolute Filtering
\lstinline!(dst port 80 or (src port 80 and dst port 25))!

\begin{lstlisting}
>> rwfilter --dport=80 --pass=out1.rwf.gz in.rwf.gz
>> rwfilter --sport=80 --dport=25 --pass=out2.rwf.gz in.rwf.gz
\end{lstlisting}

Concatenating Flow Records

\begin{lstlisting}
>> rwcat --output=out.rwf.gz out1.rwf.gz out2.rwf.gz
>> rwcat out1.rwf.gz out2.rwf.gz >> out.rwf.gz
>> rwappend [--create] out.rwf.gz out1.rwf.gz out2.rwf.gz
\end{lstlisting}

Reading Flow Records

\begin{lstlisting}
>> rwcut out.rwf.gz
\end{lstlisting}

Generating Statistical Summary

\begin{lstlisting}
>> rwstats --overall-stats out.rwf.gz
\end{lstlisting}

Creating Time Series (10 minute interval)

\begin{lstlisting}
>> rwcount --bin-size=600 out.rwf.gz
\end{lstlisting}

Sorting Flow Records (on \lstinline!srcIP!)

\begin{lstlisting}
>> rwsort --fields=1 --output=out-sort.rwf.gz out.rwf.gz
\end{lstlisting}

Grouping Flow Records and Setting Thresholds

\begin{lstlisting}
>> rwuniq --field=1 out.raw --bytes --packets=1000 --flows=200
>> rwgroup --id-field=1,2,3,4 --delta-field=9 --delta-value=3600 in.rwf.gz > out.rwf.gz
\end{lstlisting}

Remove Duplicate Flow Records

\begin{lstlisting}
>> rwdedupe --stime-delta=100 out1.rwf.gz out2.rwf.gz > out.rwf.gz
\end{lstlisting}

Splitting Flow Records

\begin{lstlisting}
>> rwsplit out.rwf.gz --basename=splits --flow-limit=1000
\end{lstlisting}

Show SiLK File Characteristics

\begin{lstlisting}
>> rwfileinfo out.rwf.gz
\end{lstlisting}

Merging Flow Records

\begin{lstlisting}
srcIP = dstIP
dstIP = srcIP
srcPort = dstPort
dstPort = srcPort

>> rwmatch --relate=1,2 --relate=2,1 --relate=3,4 --relate=4,3 query.rwf.gz response.rwf.gz stdout
\end{lstlisting}

\subsection{Generate SiLK Flow Records:}

\begin{center}\rule{3in}{0.4pt}\end{center}

Generate Flow Records from Text Files

\begin{lstlisting}
>> rwtuc --fields=1-9 out.txt > out.rwf.gz
\end{lstlisting}

Generate Flow Record for each Dumped Packet from \lstinline!tcpdump!

\begin{lstlisting}
>> rwptoflow out.pcap > out.rwf.gz
\end{lstlisting}

